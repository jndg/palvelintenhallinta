# Infraa koodina

## Tiivistys

Karvinen 2014: [Hello Salt Infra-as-Code](https://terokarvinen.com/2024/hello-salt-infra-as-code/)

Saltilla voi hallita tuhansia koneita. Tässä artikkelissa opetetaan sen käyttöä, luomalla "Hello, World!" tiedosto.

*1. Asenna salt-minion*
  ```
$ sudo apt-get update
$ sudo apt-get -y install salt-minion
```
Voit käyttää micro-editoria halutessasi
```
$ sudo apt-get -y install micro
$ export EDITOR=micro
```
*3. Luo kansio "hello"-moduulille*
Moduulit asentavat, konfiguroivat ja käynnistävät jonkin asian.
```
$ sudo mkdir -p /srv/salt/hello/
$ cd /srv/salt/hello/
```
/srv/salt/ on kansio, joka jaetaan kaikille orjatietokoneille.

*4. Kirjoita infra koodina*
Varmista että olet oikeassa kansiossa /srv/salt/hello/
```
$ sudoedit init.sls
```
Tänne voimme kirjoittaa idemponttista koodia, esimerkiksi:
```
/tmp/hellotero:
  file.managed
```
*5. Suorita*
```
$ sudo salt-call --local state.apply hello
```
Tuloksena yksityiskohtainen selitys siitä mitä tehtiin.

"file /tmp/hellotero created"

Varmistetaan, että salt teki mitä piti:
```
$ ls /tmp/hellotero
/tmp/hellotero
```

Idempotenssi

Tärkeät tilatoiminnot ovat

    pkg
    file
    service
    user
    cmd (vain jos neljää muuta ei voida käyttää).
